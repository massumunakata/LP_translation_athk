<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>料金表 HKD→JPY</title>
</head>
<body>
  <h1>HKD/JPY 本日のレート</h1>
  <div id="rate">読み込み中...</div>
  <div id="meta">更新中...</div>

  <table border="1" cellpadding="8" style="margin-top:16px; border-collapse:collapse;">
    <thead>
      <tr>
        <th>項目</th>
        <th>料金 (HKD)</th>
        <th>料金 (JPY)</th>
      </tr>
    </thead>
    <tbody id="priceTable"></tbody>
  </table>

  <script>
    const API_URL = "https://open.er-api.com/v6/latest/HKD";

    const priceData = [
      { item: "展示会半日４時間", px: 4000 },
      { item: "商談",             px: 8000 },
      { item: "会議同時通訳",     px: 10000 }
    ];

    async function fetchRateAndTable() {
      const rateEl = document.getElementById("rate");
      const metaEl = document.getElementById("meta");
      const tableEl = document.getElementById("priceTable");

      try {
        const res = await fetch(API_URL);
        const data = await res.json();
        const rate = data.rates.JPY; // HKD→JPYレート

        // レート表示
        rateEl.textContent = `1 HKD = ${rate.toFixed(3)} JPY`;

        // 更新日時
        const now = new Date().toLocaleString("ja-JP", { timeZone: "Asia/Tokyo" });
        metaEl.textContent = `更新日時: ${now}`;

        // テーブル生成
        tableEl.innerHTML = "";
        priceData.forEach(p => {
          // HKD表記（カンマ区切り）
          const hkdValue = `${p.px.toLocaleString()} HKD`;

          // JPY換算（万円単位、小数1桁、千の位四捨五入）
          const jpyValue = (p.px * rate / 10000).toFixed(1) + "万円";

          const row = `
            <tr>
              <td>${p.item}</td>
              <td>${hkdValue}</td>
              <td>${jpyValue}</td>
            </tr>
          `;
          tableEl.insertAdjacentHTML("beforeend", row);
        });

      } catch (e) {
        rateEl.textContent = "レート取得エラー";
        metaEl.textContent = "";
      }
    }

    // ページ読み込み時に実行
    fetchRateAndTable();
  </script>
</body>
</html>
